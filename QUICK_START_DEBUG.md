# Quick Start - Device Debug Inspector

## å¿«é€Ÿå¼€å§‹

### 1. å¦‚ä½•æ‰“å¼€

åœ¨è®¾å¤‡çš„å³ä¾§å·¥å…·æ ä¸­ï¼Œç‚¹å‡» "Debug" æŒ‰é’®ï¼ˆğŸ›å›¾æ ‡ï¼‰

### 2. ä¸»ç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Device Debug Inspector - [è®¾å¤‡åºåˆ—å·]          ğŸ”„ Refresh âœ• â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚               â”‚               â”‚                           â”‚
â”‚  è®¾å¤‡å±å¹•       â”‚  å±æ€§é¢æ¿      â”‚     UI å±‚æ¬¡æ ‘              â”‚
â”‚  (å¯äº¤äº’)      â”‚               â”‚     (å¯æœç´¢)               â”‚
â”‚               â”‚               â”‚                           â”‚
â”‚  - åŒå‡» Tap    â”‚  - XPath      â”‚  - æ ‘å½¢å±•ç¤º                â”‚
â”‚  - æ˜¾ç¤ºåæ ‡    â”‚  - Bounds     â”‚  - ç‚¹å‡»é€‰ä¸­                â”‚
â”‚  - é«˜äº®å…ƒç´     â”‚  - çŠ¶æ€       â”‚  - æœç´¢è¿‡æ»¤                â”‚
â”‚               â”‚               â”‚                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. åŸºæœ¬æ“ä½œ

#### æŸ¥çœ‹å…ƒç´ 

- **åœ¨ç”»å¸ƒä¸Šç‚¹å‡»** â†’ é€‰ä¸­è¯¥ä½ç½®çš„å…ƒç´ 
- **åœ¨æ ‘ä¸­ç‚¹å‡»èŠ‚ç‚¹** â†’ é€‰ä¸­è¯¥å…ƒç´ 
- é€‰ä¸­åï¼Œç”»å¸ƒä¼šé«˜äº®æ˜¾ç¤ºå…ƒç´ è¾¹ç•Œ

#### æ‰§è¡Œæ“ä½œ

- **åŒå‡»ç”»å¸ƒ** â†’ åœ¨è¯¥åæ ‡æ‰§è¡Œ Tap
- **ç‚¹å‡» "Tap on center"** â†’ ç‚¹å‡»å…ƒç´ ä¸­å¿ƒç‚¹

#### æœç´¢å…ƒç´ 

åœ¨å³ä¾§æœç´¢æ¡†è¾“å…¥å…³é”®å­—ï¼Œæ”¯æŒæœç´¢ï¼š

- textï¼ˆæŒ‰é’®æ–‡å­—ï¼‰
- content-descï¼ˆæ— éšœç¢æè¿°ï¼‰
- resource-idï¼ˆèµ„æº IDï¼‰
- classNameï¼ˆç±»åï¼‰

### 4. å¸¸è§ä½¿ç”¨åœºæ™¯

#### åœºæ™¯1ï¼šæŸ¥æ‰¾æŒ‰é’®åæ ‡

1. ç‚¹å‡» Refresh åˆ·æ–°ç•Œé¢
2. åœ¨ç”»å¸ƒä¸Šç‚¹å‡»ç›®æ ‡æŒ‰é’®
3. åœ¨å±æ€§é¢æ¿æŸ¥çœ‹ Center åæ ‡

#### åœºæ™¯2ï¼šè·å–å…ƒç´  XPath

1. é€‰ä¸­ç›®æ ‡å…ƒç´ 
2. åœ¨å±æ€§é¢æ¿å¤åˆ¶ XPath
3. ç”¨äºè‡ªåŠ¨åŒ–è„šæœ¬

#### åœºæ™¯3ï¼šæµ‹è¯•ç‚¹å‡»

1. åœ¨ç”»å¸ƒä¸ŠåŒå‡»æƒ³è¦æµ‹è¯•çš„ä½ç½®
2. è§‚å¯Ÿè®¾å¤‡æ˜¯å¦å“åº”
3. å¦‚éœ€é‡æ–°æµ‹è¯•ï¼Œç‚¹å‡» Refresh

### 5. åç«¯é…ç½®

ç¡®ä¿åç«¯ WebSocket æœåŠ¡å™¨æ”¯æŒä»¥ä¸‹æ¶ˆæ¯ï¼š

#### è¯·æ±‚æ¶ˆæ¯æ ¼å¼

```json
{
  "action": "dump_hierarchy" | "screenshot" | "tap",
  "serial": "device_serial",
  "x": 100,  // tap æ—¶éœ€è¦
  "y": 200   // tap æ—¶éœ€è¦
}
```

#### å“åº”æ¶ˆæ¯æ ¼å¼

```json
{
  "type": "hierarchy" | "screenshot" | "error",
  "data": "..." | base64_string,
  "message": "error message"  // é”™è¯¯æ—¶
}
```

### 6. æ•…éšœæ’æŸ¥

#### æ— æ³•è¿æ¥

- æ£€æŸ¥ WebSocket æœåŠ¡æ˜¯å¦è¿è¡Œåœ¨ 9008 ç«¯å£
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

#### æ— æ³•è·å–æˆªå›¾

- ç¡®ä¿è®¾å¤‡æœ‰å±å¹•è¾“å‡º
- æ£€æŸ¥åç«¯æ˜¯å¦æ­£ç¡®å®ç° screenshot API

#### ç‚¹å‡»æ— å“åº”

- éªŒè¯åæ ‡æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥åç«¯ tap åŠŸèƒ½å®ç°

### 7. é”®ç›˜å¿«æ·é”®ï¼ˆå¾…å®ç°ï¼‰

- `Ctrl + R` - åˆ·æ–°
- `Ctrl + F` - æœç´¢
- `Esc` - å…³é—­å¯¹è¯æ¡†

### 8. æ€§èƒ½æç¤º

- å¤§å‹å±‚æ¬¡æ ‘å¯èƒ½åŠ è½½è¾ƒæ…¢
- é¢‘ç¹åˆ·æ–°å¯èƒ½å½±å“æ€§èƒ½
- å»ºè®®åœ¨éœ€è¦æ—¶å†æ‰“å¼€ Debug çª—å£

## å¼€å‘é›†æˆ

å¦‚æœéœ€è¦åœ¨å…¶ä»–åœ°æ–¹æ‰“å¼€ Debug Dialogï¼š

```javascript
// è§¦å‘äº‹ä»¶
await this.$emiter('openDebugDialog', {
  serial: 'device_serial',
  real_serial: 'device_real_serial'
})
```

## API å‚è€ƒ

### useDeviceDebugService

```javascript
import { useDeviceDebugService } from '@/service/debugService'

const {
  connected,      // WebSocket è¿æ¥çŠ¶æ€
  loading,        // åŠ è½½çŠ¶æ€
  screenshot,     // æˆªå›¾æ•°æ®
  hierarchy,      // å±‚æ¬¡ç»“æ„ XML
  error,          // é”™è¯¯ä¿¡æ¯
  connect,        // è¿æ¥å‡½æ•°
  dumpHierarchy,  // Dump å±‚æ¬¡ç»“æ„
  getScreenshot,  // è·å–æˆªå›¾
  tap,            // æ‰§è¡Œ Tap
  disconnect      // æ–­å¼€è¿æ¥
} = useDeviceDebugService('device_serial')
```

### hierarchyParser

```javascript
import { 
  parseXmlHierarchy,    // è§£æ XML
  generateXPathLite,    // ç”Ÿæˆ XPath
  findNodesByText,      // æŒ‰æ–‡æœ¬æŸ¥æ‰¾
  findNodeById,         // æŒ‰ ID æŸ¥æ‰¾
  flattenTree          // æ‰å¹³åŒ–æ ‘
} from '@/utils/hierarchyParser'
```

### canvasDrawer

```javascript
import {
  drawHighlight,         // ç»˜åˆ¶é«˜äº®
  clearCanvas,           // æ¸…ç©ºç”»å¸ƒ
  drawScreenshot,        // ç»˜åˆ¶æˆªå›¾
  getDeviceCoordinates, // è·å–è®¾å¤‡åæ ‡
  scaleBoundsToCanvas   // ç¼©æ”¾è¾¹ç•Œ
} from '@/utils/canvasDrawer'
```
